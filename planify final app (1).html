<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planify - Your Productivity Hub</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #6b8cbc;
            --accent-color: #ff7e5f;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --text-light: #f8f9fa;
            --text-dark: #343a40;
            --bg-light: #f5f5f5;
            --bg-dark: #2d3748;
            --card-light: rgba(255, 255, 255, 0.85);
            --card-dark: rgba(74, 85, 104, 0.85);
            --sidebar-light: rgba(255, 255, 255, 0.9);
            --sidebar-dark: rgba(45, 55, 72, 0.9);
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --transition: all 0.3s ease;
            --gradient-primary: linear-gradient(135deg, #4a6fa5, #6b8cbc);
            --gradient-accent: linear-gradient(135deg, #ff7e5f, #ff9e7d);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-light);
            color: var(--text-dark);
            transition: var(--transition);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        body.dark-mode {
            background-color: var(--bg-dark);
            color: var(--text-light);
        }

        /* Spotify-like Background */
        .spotify-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .gradient-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(74, 111, 165, 0.8), rgba(107, 140, 188, 0.6), rgba(255, 126, 95, 0.4));
            z-index: 1;
        }

        .particles-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float 15s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 0.7;
            }
            33% {
                transform: translateY(-30px) translateX(20px) rotate(120deg);
                opacity: 0.4;
            }
            66% {
                transform: translateY(20px) translateX(-20px) rotate(240deg);
                opacity: 0.6;
            }
            100% {
                transform: translateY(0) translateX(0) rotate(360deg);
                opacity: 0.7;
            }
        }

        /* Login Page Styles */
        .login-page {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: white;
            text-align: center;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .login-container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: var(--border-radius);
            padding: 40px;
            width: 100%;
            max-width: 450px;
            box-shadow: var(--shadow-lg);
            color: var(--text-dark);
            z-index: 1;
            position: relative;
            backdrop-filter: blur(10px);
        }

        body.dark-mode .login-container {
            background: rgba(45, 55, 72, 0.9);
            color: var(--text-light);
        }

        .login-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
        }

        .login-logo {
            font-size: 3.5rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .login-title {
            font-size: 2.2rem;
            margin-bottom: 5px;
            color: var(--primary-color);
        }

        .login-subtitle {
            margin-bottom: 30px;
            color: #6c757d;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .form-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .form-group input {
            padding: 12px 15px;
            border: none;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-group input:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--primary-color);
        }

        .login-actions {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .login-btn {
            padding: 12px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .login-btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .toggle-auth {
            background: transparent;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            margin-top: 10px;
            align-self: flex-start;
        }

        .demo-credentials {
            margin-top: 20px;
            padding: 15px;
            background: rgba(74, 111, 165, 0.1);
            border-radius: var(--border-radius);
            font-size: 0.9rem;
        }

        .password-strength {
            height: 5px;
            margin-top: 5px;
            border-radius: 5px;
            background-color: #e9ecef;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            width: 0%;
            transition: var(--transition);
        }

        .password-strength.weak .password-strength-bar {
            background-color: var(--danger-color);
            width: 33%;
        }

        .password-strength.medium .password-strength-bar {
            background-color: var(--warning-color);
            width: 66%;
        }

        .password-strength.strong .password-strength-bar {
            background-color: var(--success-color);
            width: 100%;
        }

        .password-match {
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
        }

        .password-match.valid {
            color: var(--success-color);
            display: block;
        }

        .password-match.invalid {
            color: var(--danger-color);
            display: block;
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .create-account-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        .create-account-text {
            font-size: 0.9rem;
            color: #6c757d;
        }

        .create-account-btn {
            padding: 10px 20px;
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .create-account-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        /* App Layout */
        .app-container {
            display: none;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background-color: var(--card-light);
            box-shadow: var(--shadow);
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        body.dark-mode .app-header {
            background-color: var(--card-dark);
        }

        .app-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        body.dark-mode .app-title {
            color: var(--secondary-color);
        }

        .user-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 8px 15px;
            background-color: var(--card-light);
            border-radius: 50px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        body.dark-mode .theme-toggle {
            background-color: var(--card-dark);
        }

        .theme-toggle:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 8px 15px;
            background-color: var(--card-light);
            border-radius: 50px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
        }

        body.dark-mode .user-profile {
            background-color: var(--card-dark);
        }

        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .profile-menu {
            position: absolute;
            top: 70px;
            right: 30px;
            background-color: var(--card-light);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            padding: 15px;
            width: 200px;
            display: none;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        body.dark-mode .profile-menu {
            background-color: var(--card-dark);
        }

        .profile-menu p {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        body.dark-mode .profile-menu p {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .profile-menu button {
            width: 100%;
            margin-top: 10px;
            padding: 10px;
            border: none;
            border-radius: var(--border-radius);
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: var(--transition);
        }

        .profile-menu button:hover {
            background-color: var(--secondary-color);
        }

        /* Main Content Area */
        .app-main {
            display: flex;
            height: calc(100vh - 70px);
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 250px;
            background-color: var(--sidebar-light);
            box-shadow: var(--shadow);
            padding: 20px 0;
            overflow-y: auto;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        body.dark-mode .sidebar {
            background-color: var(--sidebar-dark);
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
        }

        body.dark-mode .sidebar-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
        }

        body.dark-mode .sidebar-title {
            color: var(--secondary-color);
        }

        .nav-section {
            margin-bottom: 25px;
        }

        .nav-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            color: #6c757d;
            padding: 0 20px;
            margin-bottom: 10px;
        }

        body.dark-mode .nav-section-title {
            color: #a0aec0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            cursor: pointer;
            transition: var(--transition);
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background-color: rgba(74, 111, 165, 0.1);
        }

        body.dark-mode .nav-item:hover {
            background-color: rgba(74, 111, 165, 0.2);
        }

        .nav-item.active {
            background-color: rgba(74, 111, 165, 0.1);
            border-left: 3px solid var(--primary-color);
            color: var(--primary-color);
        }

        body.dark-mode .nav-item.active {
            background-color: rgba(74, 111, 165, 0.2);
        }

        .nav-icon {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            position: relative;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .content-header {
            margin-bottom: 30px;
        }

        .content-title {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        body.dark-mode .content-title {
            color: var(--secondary-color);
        }

        .content-subtitle {
            font-size: 1.1rem;
            color: #6c757d;
        }

        body.dark-mode .content-subtitle {
            color: #a0aec0;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background-color: var(--card-light);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        body.dark-mode .dashboard-card {
            background-color: var(--card-dark);
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-color);
        }

        body.dark-mode .card-title {
            color: var(--secondary-color);
        }

        .card-action {
            color: var(--accent-color);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Welcome Header */
        .welcome-header {
            background: var(--gradient-primary);
            color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .welcome-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="white" opacity="0.1"/></svg>');
            background-size: 200px 200px;
        }

        .greeting-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .greeting-text h2 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .date-time {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .motivational-quote {
            font-style: italic;
            text-align: center;
            font-size: 1.2rem;
            margin-top: 15px;
            opacity: 0.9;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: var(--card-light);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        body.dark-mode .stat-card {
            background-color: var(--card-dark);
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        body.dark-mode .stat-value {
            color: var(--secondary-color);
        }

        .stat-label {
            font-size: 1rem;
            color: #6c757d;
        }

        body.dark-mode .stat-label {
            color: #a0aec0;
        }

        /* Progress Bar */
        .progress-bar {
            height: 20px;
            background-color: #e9ecef;
            border-radius: 10px;
            margin-top: 10px;
            overflow: hidden;
        }

        body.dark-mode .progress-bar {
            background-color: #4a5568;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }

        /* Task List */
        .task-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .task-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background-color: var(--card-light);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        body.dark-mode .task-item {
            background-color: var(--card-dark);
        }

        .task-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .task-checkbox {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #6c757d;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .task-checkbox.checked {
            background-color: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .task-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: #6c757d;
        }

        body.dark-mode .task-meta {
            color: #a0aec0;
        }

        .task-priority {
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .priority-high {
            background-color: rgba(220, 53, 69, 0.2);
            color: var(--danger-color);
        }

        .priority-medium {
            background-color: rgba(255, 193, 7, 0.2);
            color: var(--warning-color);
        }

        .priority-low {
            background-color: rgba(40, 167, 69, 0.2);
            color: var(--success-color);
        }

        /* Task Form */
        .task-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-row input, .form-row select {
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            font-size: 1rem;
            transition: var(--transition);
            background-color: var(--card-light);
        }

        body.dark-mode .form-row input, body.dark-mode .form-row select {
            background-color: var(--card-dark);
            color: var(--text-light);
        }

        .form-row input:focus, .form-row select:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--primary-color);
        }

        .add-task-btn {
            padding: 12px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .add-task-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        /* Calendar */
        .calendar {
            width: 100%;
            border-collapse: collapse;
            background-color: var(--card-light);
            backdrop-filter: blur(10px);
        }

        body.dark-mode .calendar {
            background-color: var(--card-dark);
        }

        .calendar th, .calendar td {
            padding: 10px;
            text-align: center;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        body.dark-mode .calendar th, body.dark-mode .calendar td {
            border-color: rgba(255, 255, 255, 0.1);
        }

        .calendar th {
            background-color: var(--primary-color);
            color: white;
        }

        .calendar .today {
            background-color: rgba(255, 126, 95, 0.2);
            font-weight: bold;
        }

        .calendar .has-task {
            position: relative;
        }

        .calendar .has-task::after {
            content: '';
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            background-color: var(--accent-color);
            border-radius: 50%;
        }

        /* Charts */
        .chart-container {
            height: 300px;
            margin-bottom: 20px;
        }

        /* Mood Tracker */
        .mood-tracker {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }

        .mood-option {
            font-size: 2.5rem;
            cursor: pointer;
            transition: var(--transition);
            opacity: 0.7;
        }

        .mood-option:hover, .mood-option.selected {
            transform: scale(1.2);
            opacity: 1;
        }

        /* Focus Timer */
        .timer-display {
            font-size: 3rem;
            text-align: center;
            margin: 20px 0;
            font-family: monospace;
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .timer-btn {
            padding: 10px 20px;
            border: none;
            border-radius: var(--border-radius);
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: var(--transition);
        }

        .timer-btn:hover {
            background-color: var(--secondary-color);
        }

        /* AI Chat Widget */
        .ai-chat-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            height: 450px;
            background-color: var(--card-light);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            display: none;
            flex-direction: column;
            z-index: 1000;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        body.dark-mode .ai-chat-widget {
            background-color: var(--card-dark);
        }

        .chat-header {
            padding: 15px;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
        }

        .message {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 10px;
            max-width: 80%;
        }

        .message.user {
            background-color: var(--primary-color);
            color: white;
            margin-left: auto;
        }

        .message.ai {
            background-color: var(--card-light);
            color: var(--text-dark);
        }

        body.dark-mode .message.ai {
            background-color: var(--card-dark);
            color: var(--text-light);
        }

        .chat-input {
            display: flex;
            padding: 10px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        body.dark-mode .chat-input {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chat-input input {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: var(--border-radius);
            margin-right: 10px;
            background-color: var(--card-light);
        }

        body.dark-mode .chat-input input {
            background-color: var(--card-dark);
            color: var(--text-light);
        }

        .send-btn {
            padding: 10px 15px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
        }

        .ai-assistant {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            transition: var(--transition);
        }

        .ai-assistant:hover {
            transform: scale(1.1);
        }

        /* Notification System */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .notification {
            padding: 15px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 350px;
            animation: slideIn 0.3s ease;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .notification.success {
            background-color: rgba(40, 167, 69, 0.9);
            color: white;
        }

        .notification.error {
            background-color: rgba(220, 53, 69, 0.9);
            color: white;
        }

        .notification.info {
            background-color: rgba(74, 111, 165, 0.9);
            color: white;
        }

        .notification.warning {
            background-color: rgba(255, 193, 7, 0.9);
            color: var(--text-dark);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .app-main {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
            
            .login-title {
                font-size: 1.8rem;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .ai-chat-widget {
                width: calc(100% - 40px);
                right: 20px;
                left: 20px;
            }
            
            .profile-menu {
                right: 10px;
                width: 180px;
            }
        }
    </style>
</head>
<body>
    <!-- Spotify-like Background -->
    <div class="spotify-background" id="spotifyBackground">
        <div class="gradient-overlay"></div>
        <div class="particles-container" id="particlesContainer"></div>
    </div>

    <!-- Notification Container -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- Login Page -->
    <div class="login-page" id="loginPage">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo">
                    <i class="fas fa-tasks"></i>
                </div>
                <h1 class="login-title">Planify</h1>
                <p class="login-subtitle" id="loginSubtitle">Sign in to access your productivity dashboard</p>
            </div>
            
            <!-- Login Form -->
            <div class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Email Address</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email">
                </div>
                
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password">
                </div>
                
                <div class="login-actions">
                    <button class="login-btn" id="loginBtn">Sign In</button>
                </div>
                
                <div class="create-account-section">
                    <div class="create-account-text">
                        Don't have an account?
                    </div>
                    <button class="create-account-btn" id="createAccountBtn">Create Account</button>
                </div>
                
                <div class="demo-credentials">
                    <p><strong>Demo Credentials:</strong></p>
                    <p>Email: <strong>demo@example.com</strong></p>
                    <p>Password: <strong>demo</strong></p>
                </div>
            </div>
            
            <!-- Signup Form -->
            <div class="login-form" id="signupForm" style="display: none;">
                <div class="form-row">
                    <div class="form-group">
                        <label for="signupFirstName">First Name</label>
                        <input type="text" id="signupFirstName" placeholder="Enter your first name">
                    </div>
                    <div class="form-group">
                        <label for="signupLastName">Last Name</label>
                        <input type="text" id="signupLastName" placeholder="Enter your last name">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="signupEmail">Email Address</label>
                    <input type="email" id="signupEmail" placeholder="Enter your email">
                </div>
                
                <div class="form-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" placeholder="Create a password">
                    <div class="password-strength" id="passwordStrength">
                        <div class="password-strength-bar"></div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="signupConfirmPassword">Confirm Password</label>
                    <input type="password" id="signupConfirmPassword" placeholder="Confirm your password">
                    <div class="password-match" id="passwordMatch"></div>
                </div>
                
                <div class="login-actions">
                    <button class="login-btn" id="signupBtn">Create Account</button>
                </div>
                
                <div class="create-account-section">
                    <div class="create-account-text">
                        Already have an account?
                    </div>
                    <button class="create-account-btn" id="backToLoginBtn">Sign In</button>
                </div>
            </div>
        </div>
    </div>

    <!-- App Container -->
    <div class="app-container" id="appContainer">
        <!-- App Header -->
        <header class="app-header">
            <div class="app-title">Planify</div>
            <div class="user-controls">
                <div class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                    <span>Dark Mode</span>
                </div>
                <div class="user-profile" id="userProfile">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <span id="userName">User</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="profile-menu" id="profileMenu">
                    <p id="profileEmail">Email: </p>
                    <button id="logoutBtn">Logout</button>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <div class="app-main">
            <!-- Sidebar Navigation -->
            <nav class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title">Navigation</div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Main</div>
                    <div class="nav-item active" data-content="dashboard">
                        <i class="fas fa-home nav-icon"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="nav-item" data-content="tasks">
                        <i class="fas fa-tasks nav-icon"></i>
                        <span>Tasks</span>
                    </div>
                    <div class="nav-item" data-content="calendar">
                        <i class="fas fa-calendar-alt nav-icon"></i>
                        <span>Calendar</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Analytics</div>
                    <div class="nav-item" data-content="analytics">
                        <i class="fas fa-chart-bar nav-icon"></i>
                        <span>Analytics</span>
                    </div>
                    <div class="nav-item" data-content="reports">
                        <i class="fas fa-chart-pie nav-icon"></i>
                        <span>Reports</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Tools</div>
                    <div class="nav-item" data-content="focus">
                        <i class="fas fa-bullseye nav-icon"></i>
                        <span>Today's Focus</span>
                    </div>
                    <div class="nav-item" data-content="deadlines">
                        <i class="fas fa-clock nav-icon"></i>
                        <span>Upcoming Deadlines</span>
                    </div>
                    <div class="nav-item" data-content="timer">
                        <i class="fas fa-hourglass-half nav-icon"></i>
                        <span>Focus Timer</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Motivation</div>
                    <div class="nav-item" data-content="quotes">
                        <i class="fas fa-quote-left nav-icon"></i>
                        <span>Daily Quotes</span>
                    </div>
                    <div class="nav-item" data-content="mood">
                        <i class="fas fa-smile nav-icon"></i>
                        <span>How Are You Feeling?</span>
                    </div>
                    <div class="nav-item" data-content="challenge">
                        <i class="fas fa-trophy nav-icon"></i>
                        <span>Daily Challenge</span>
                    </div>
                </div>
            </nav>

            <!-- Content Area -->
            <main class="content-area" id="contentArea">
                <!-- Dashboard Content -->
                <div class="content-section active" id="dashboardContent">
                    <div class="content-header">
                        <h1 class="content-title">Dashboard</h1>
                        <p class="content-subtitle">Welcome back! Here's your productivity overview</p>
                    </div>
                    
                    <!-- Welcome Header -->
                    <div class="welcome-header">
                        <div class="greeting-section">
                            <div class="greeting-text">
                                <h2 id="greetingMessage">Good Morning, User!</h2>
                                <div class="date-time" id="currentDateTime">Loading date and time...</div>
                            </div>
                            <div class="streak-display">
                                <div class="streak-count" id="streakCount">ðŸ”¥ 0 day streak</div>
                            </div>
                        </div>
                        <div class="motivational-quote" id="dailyQuote">
                            "The secret of getting ahead is getting started." - Mark Twain
                        </div>
                    </div>
                    
                    <!-- Stats Overview -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="totalTasks">0</div>
                            <div class="stat-label">Total Tasks</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="completedTasks">0</div>
                            <div class="stat-label">Completed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="pendingTasks">0</div>
                            <div class="stat-label">Pending</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="overdueTasks">0</div>
                            <div class="stat-label">Overdue</div>
                        </div>
                    </div>
                    
                    <!-- Progress Section -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Completion Progress</h3>
                            <span class="card-action">View Details</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress" id="progressBar"></div>
                        </div>
                        <div class="progress-text" style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span>Overall Progress</span>
                            <span id="progressPercentage">0%</span>
                        </div>
                    </div>
                    
                    <!-- Today's Focus -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Today's Focus</h3>
                            <span class="card-action" id="viewAllFocus">View All</span>
                        </div>
                        <div class="task-list" id="focusTasks">
                            <!-- Focus tasks will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Upcoming Deadlines -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Upcoming Deadlines</h3>
                            <span class="card-action" id="viewAllDeadlines">View All</span>
                        </div>
                        <div class="task-list" id="upcomingDeadlines">
                            <!-- Upcoming deadlines will be populated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Tasks Content -->
                <div class="content-section" id="tasksContent">
                    <div class="content-header">
                        <h1 class="content-title">Task Management</h1>
                        <p class="content-subtitle">Manage all your tasks in one place</p>
                    </div>
                    
                    <div class="dashboard-card">
                        <h3>Add New Task</h3>
                        <div class="task-form">
                            <div class="form-row">
                                <input type="text" id="taskTitle" placeholder="Task title">
                                <input type="date" id="taskDueDate">
                            </div>
                            <div class="form-row">
                                <select id="taskCategory">
                                    <option value="general">General</option>
                                    <option value="work">Work</option>
                                    <option value="personal">Personal</option>
                                    <option value="health">Health</option>
                                </select>
                                <select id="taskPriority">
                                    <option value="low">Low Priority</option>
                                    <option value="medium" selected>Medium Priority</option>
                                    <option value="high">High Priority</option>
                                </select>
                            </div>
                            <button class="add-task-btn" id="addTaskBtn">
                                <i class="fas fa-plus"></i> Add Task
                            </button>
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h3>Your Tasks</h3>
                        <div class="task-list" id="allTasksList">
                            <!-- All tasks will be populated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Calendar Content -->
                <div class="content-section" id="calendarContent">
                    <div class="content-header">
                        <h1 class="content-title">Calendar</h1>
                        <p class="content-subtitle">View your tasks on a calendar</p>
                    </div>
                    <div class="dashboard-card">
                        <div id="calendarView">
                            <!-- Calendar will be generated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Analytics Content -->
                <div class="content-section" id="analyticsContent">
                    <div class="content-header">
                        <h1 class="content-title">Analytics</h1>
                        <p class="content-subtitle">Track your productivity trends</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>Task Completion Trends</h3>
                        <div class="chart-container">
                            <canvas id="completionChart"></canvas>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Tasks by Category</h3>
                        <div class="chart-container">
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Reports Content -->
                <div class="content-section" id="reportsContent">
                    <div class="content-header">
                        <h1 class="content-title">Reports</h1>
                        <p class="content-subtitle">Detailed productivity reports</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>Weekly Performance</h3>
                        <div class="chart-container">
                            <canvas id="weeklyChart"></canvas>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Productivity Insights</h3>
                        <div id="productivityInsights">
                            <!-- Insights will be generated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Today's Focus Content -->
                <div class="content-section" id="focusContent">
                    <div class="content-header">
                        <h1 class="content-title">Today's Focus</h1>
                        <p class="content-subtitle">Your priority tasks for today</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>Focus Tasks</h3>
                        <div class="task-list" id="focusTasksDetailed">
                            <!-- Focus tasks will be populated here -->
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Focus Mode</h3>
                        <p>Enable focus mode to minimize distractions and concentrate on your tasks.</p>
                        <button class="add-task-btn" id="enableFocusMode">
                            <i class="fas fa-bullseye"></i> Enable Focus Mode
                        </button>
                    </div>
                </div>
                
                <!-- Upcoming Deadlines Content -->
                <div class="content-section" id="deadlinesContent">
                    <div class="content-header">
                        <h1 class="content-title">Upcoming Deadlines</h1>
                        <p class="content-subtitle">Tasks with approaching due dates</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>Deadline Overview</h3>
                        <div class="task-list" id="deadlinesList">
                            <!-- Deadlines will be populated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Focus Timer Content -->
                <div class="content-section" id="timerContent">
                    <div class="content-header">
                        <h1 class="content-title">Focus Timer</h1>
                        <p class="content-subtitle">Pomodoro technique timer for focused work sessions</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>Timer</h3>
                        <div class="timer-display" id="timerDisplay">25:00</div>
                        <div class="timer-controls">
                            <button class="timer-btn" id="startTimer">Start</button>
                            <button class="timer-btn" id="pauseTimer">Pause</button>
                            <button class="timer-btn" id="resetTimer">Reset</button>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Timer Settings</h3>
                        <div class="form-row">
                            <select id="timerDuration">
                                <option value="25">25 minutes</option>
                                <option value="50">50 minutes</option>
                                <option value="90">90 minutes</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Daily Quotes Content -->
                <div class="content-section" id="quotesContent">
                    <div class="content-header">
                        <h1 class="content-title">Daily Quotes</h1>
                        <p class="content-subtitle">Get inspired with motivational quotes</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>Quote of the Day</h3>
                        <div id="dailyQuoteDetailed">
                            <!-- Quote will be populated here -->
                        </div>
                        <button class="add-task-btn" id="newQuoteBtn" style="margin-top: 20px;">
                            <i class="fas fa-sync"></i> New Quote
                        </button>
                    </div>
                    <div class="dashboard-card">
                        <h3>Favorite Quotes</h3>
                        <div id="favoriteQuotes">
                            <!-- Favorite quotes will be populated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Mood Tracker Content -->
                <div class="content-section" id="moodContent">
                    <div class="content-header">
                        <h1 class="content-title">How Are You Feeling?</h1>
                        <p class="content-subtitle">Track your mood and emotions</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>Today's Mood</h3>
                        <div class="mood-tracker">
                            <div class="mood-option" data-mood="happy">ðŸ˜Š</div>
                            <div class="mood-option" data-mood="neutral">ðŸ˜</div>
                            <div class="mood-option" data-mood="sad">ðŸ˜”</div>
                            <div class="mood-option" data-mood="excited">ðŸ˜„</div>
                            <div class="mood-option" data-mood="tired">ðŸ˜´</div>
                        </div>
                        <div id="moodMessage" style="text-align: center; margin-top: 20px;"></div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Mood History</h3>
                        <div class="chart-container">
                            <canvas id="moodChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Daily Challenge Content -->
                <div class="content-section" id="challengeContent">
                    <div class="content-header">
                        <h1 class="content-title">Daily Challenge</h1>
                        <p class="content-subtitle">Complete challenges to boost your productivity</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>Today's Challenge</h3>
                        <div id="dailyChallenge">
                            <!-- Challenge will be populated here -->
                        </div>
                        <div class="progress-bar" style="margin-top: 20px;">
                            <div class="progress" id="challengeProgress" style="width: 0%"></div>
                        </div>
                        <div class="progress-text" style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span>Challenge Progress</span>
                            <span id="challengePercentage">0%</span>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Challenge History</h3>
                        <div id="challengeHistory">
                            <!-- Challenge history will be populated here -->
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- AI Chat Widget -->
    <div class="ai-chat-widget" id="aiChatWidget">
        <div class="chat-header">
            <span>AI Assistant</span>
            <i class="fas fa-times" id="closeChat"></i>
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="message ai">
                Hello! I'm your productivity assistant. How can I help you today?
            </div>
        </div>
        <div class="chat-input">
            <input type="text" id="chatInput" placeholder="Type your message...">
            <button class="send-btn" id="sendMessage"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <div class="ai-assistant" id="aiAssistant">
        <i class="fas fa-robot"></i>
    </div>

    <script>
        // Debug logging
        console.log("App initializing...");

        // DOM Elements
        const loginPage = document.getElementById('loginPage');
        const appContainer = document.getElementById('appContainer');
        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        const loginSubtitle = document.getElementById('loginSubtitle');
        const loginBtn = document.getElementById('loginBtn');
        const signupBtn = document.getElementById('signupBtn');
        const createAccountBtn = document.getElementById('createAccountBtn');
        const backToLoginBtn = document.getElementById('backToLoginBtn');
        const loginEmail = document.getElementById('loginEmail');
        const loginPassword = document.getElementById('loginPassword');
        const signupFirstName = document.getElementById('signupFirstName');
        const signupLastName = document.getElementById('signupLastName');
        const signupEmail = document.getElementById('signupEmail');
        const signupPassword = document.getElementById('signupPassword');
        const signupConfirmPassword = document.getElementById('signupConfirmPassword');
        const passwordStrength = document.getElementById('passwordStrength');
        const passwordMatch = document.getElementById('passwordMatch');
        const themeToggle = document.getElementById('themeToggle');
        const userProfile = document.getElementById('userProfile');
        const userAvatar = document.getElementById('userAvatar');
        const userName = document.getElementById('userName');
        const profileMenu = document.getElementById('profileMenu');
        const profileEmail = document.getElementById('profileEmail');
        const logoutBtn = document.getElementById('logoutBtn');
        const navItems = document.querySelectorAll('.nav-item');
        const contentSections = document.querySelectorAll('.content-section');
        const greetingMessage = document.getElementById('greetingMessage');
        const currentDateTime = document.getElementById('currentDateTime');
        const dailyQuote = document.getElementById('dailyQuote');
        const streakCount = document.getElementById('streakCount');
        const totalTasks = document.getElementById('totalTasks');
        const completedTasks = document.getElementById('completedTasks');
        const pendingTasks = document.getElementById('pendingTasks');
        const overdueTasks = document.getElementById('overdueTasks');
        const progressBar = document.getElementById('progressBar');
        const progressPercentage = document.getElementById('progressPercentage');
        const focusTasks = document.getElementById('focusTasks');
        const upcomingDeadlines = document.getElementById('upcomingDeadlines');
        const taskTitle = document.getElementById('taskTitle');
        const taskDueDate = document.getElementById('taskDueDate');
        const taskCategory = document.getElementById('taskCategory');
        const taskPriority = document.getElementById('taskPriority');
        const addTaskBtn = document.getElementById('addTaskBtn');
        const allTasksList = document.getElementById('allTasksList');
        const timerDisplay = document.getElementById('timerDisplay');
        const startTimer = document.getElementById('startTimer');
        const pauseTimer = document.getElementById('pauseTimer');
        const resetTimer = document.getElementById('resetTimer');
        const timerDuration = document.getElementById('timerDuration');
        const dailyQuoteDetailed = document.getElementById('dailyQuoteDetailed');
        const newQuoteBtn = document.getElementById('newQuoteBtn');
        const moodMessage = document.getElementById('moodMessage');
        const dailyChallenge = document.getElementById('dailyChallenge');
        const challengeProgress = document.getElementById('challengeProgress');
        const challengePercentage = document.getElementById('challengePercentage');
        const aiAssistant = document.getElementById('aiAssistant');
        const aiChatWidget = document.getElementById('aiChatWidget');
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const sendMessage = document.getElementById('sendMessage');
        const closeChat = document.getElementById('closeChat');
        const notificationContainer = document.getElementById('notificationContainer');
        const particlesContainer = document.getElementById('particlesContainer');

        // Global variables
        let tasks = [];
        let currentUser = null;
        let users = [];
        let streakData = { currentStreak: 0, lastActiveDate: null };
        let timerSeconds = 25 * 60;
        let isTimerRunning = false;
        let timerInterval = null;
        let currentMood = null;
        let moodHistory = [];
        let challengeData = { progress: 0, completed: false, lastChallengeDate: null };
        let quotes = [
            "The secret of getting ahead is getting started. - Mark Twain",
            "It's not that I'm so smart, it's just that I stay with problems longer. - Albert Einstein",
            "The way to get started is to quit talking and begin doing. - Walt Disney",
            "Don't let yesterday take up too much of today. - Will Rogers",
            "You learn more from failure than from success. Don't let it stop you. - Unknown",
            "It does not matter how slowly you go as long as you do not stop. - Confucius",
            "Quality is not an act, it is a habit. - Aristotle",
            "The future depends on what you do today. - Mahatma Gandhi",
            "Believe you can and you're halfway there. - Theodore Roosevelt",
            "The only way to do great work is to love what you do. - Steve Jobs"
        ];
        let challenges = [
            "Complete 3 tasks before lunch",
            "Work for 25 minutes without distractions",
            "Organize your task list by priority",
            "Review and update your calendar",
            "Take a 5-minute break every hour"
        ];
        
        // Chart instances
        let completionChart = null;
        let categoryChart = null;
        let weeklyChart = null;
        let moodChart = null;

        // Initialize data from localStorage
        function initializeData() {
            console.log("Initializing data from localStorage...");
            
            try {
                // Initialize tasks
                const storedTasks = localStorage.getItem('tasks');
                tasks = storedTasks ? JSON.parse(storedTasks) : [];
                console.log("Tasks loaded:", tasks.length);
                
                // Initialize users
                const storedUsers = localStorage.getItem('users');
                users = storedUsers ? JSON.parse(storedUsers) : [
                    { 
                        id: 1, 
                        firstName: 'Demo',
                        lastName: 'User',
                        email: 'demo@example.com', 
                        password: 'demo', 
                        theme: 'light'
                    }
                ];
                console.log("Users loaded:", users.length);
                
                // Initialize streak data
                const storedStreak = localStorage.getItem('streakData');
                streakData = storedStreak ? JSON.parse(storedStreak) : { currentStreak: 0, lastActiveDate: null };
                console.log("Streak data loaded:", streakData);
                
                // Initialize mood history
                const storedMood = localStorage.getItem('moodHistory');
                moodHistory = storedMood ? JSON.parse(storedMood) : [];
                console.log("Mood history loaded:", moodHistory.length);
                
                // Initialize challenge data
                const storedChallenge = localStorage.getItem('challengeData');
                challengeData = storedChallenge ? JSON.parse(storedChallenge) : { progress: 0, completed: false, lastChallengeDate: null };
                console.log("Challenge data loaded:", challengeData);
                
            } catch (error) {
                console.error("Error loading data from localStorage:", error);
                // Reset to default values if there's an error
                tasks = [];
                users = [
                    { 
                        id: 1, 
                        firstName: 'Demo',
                        lastName: 'User',
                        email: 'demo@example.com', 
                        password: 'demo', 
                        theme: 'light'
                    }
                ];
                streakData = { currentStreak: 0, lastActiveDate: null };
                moodHistory = [];
                challengeData = { progress: 0, completed: false, lastChallengeDate: null };
            }
        }

        // Initialize the application
        function init() {
            console.log("Initializing application...");
            
            // Initialize data first
            initializeData();
            
            // Set minimum date for due date input to today
            const today = new Date().toISOString().split('T')[0];
            if (taskDueDate) {
                taskDueDate.min = today;
                console.log("Task due date min set to:", today);
            }
            
            updateDateTime();
            setInterval(updateDateTime, 1000);
            
            // Create animated particles
            createParticles();
            
            // Setup event listeners
            setupEventListeners();
            
            // Check for expired tasks
            checkForExpiredTasks();
            
            // Check if user is already logged in
            checkLoginStatus();
            
            console.log("Application initialized successfully");
        }

        // Setup all event listeners
        function setupEventListeners() {
            console.log("Setting up event listeners...");
            
            // Authentication
            if (loginBtn) loginBtn.addEventListener('click', handleLogin);
            if (signupBtn) signupBtn.addEventListener('click', handleSignup);
            if (createAccountBtn) createAccountBtn.addEventListener('click', showSignupForm);
            if (backToLoginBtn) backToLoginBtn.addEventListener('click', showLoginForm);
            
            // Theme and user controls
            if (themeToggle) themeToggle.addEventListener('click', toggleTheme);
            if (userProfile) userProfile.addEventListener('click', toggleProfileMenu);
            if (logoutBtn) logoutBtn.addEventListener('click', handleLogout);
            
            // Task management
            if (addTaskBtn) addTaskBtn.addEventListener('click', addNewTask);
            
            // Timer controls
            if (startTimer) startTimer.addEventListener('click', startFocusTimer);
            if (pauseTimer) pauseTimer.addEventListener('click', pauseFocusTimer);
            if (resetTimer) resetTimer.addEventListener('click', resetFocusTimer);
            if (timerDuration) timerDuration.addEventListener('change', updateTimerDuration);
            
            // Quotes and mood
            if (newQuoteBtn) newQuoteBtn.addEventListener('click', updateDailyQuote);
            
            // AI Chat
            if (aiAssistant) aiAssistant.addEventListener('click', toggleAIChat);
            if (closeChat) closeChat.addEventListener('click', toggleAIChat);
            if (sendMessage) sendMessage.addEventListener('click', sendAIMessage);
            if (chatInput) {
                chatInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') sendAIMessage();
                });
            }
            
            // Password strength indicators
            if (signupPassword) signupPassword.addEventListener('input', checkPasswordStrength);
            if (signupConfirmPassword) signupConfirmPassword.addEventListener('input', checkPasswordMatch);
            
            // Navigation
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Remove active class from all items
                    navItems.forEach(nav => nav.classList.remove('active'));
                    // Add active class to clicked item
                    this.classList.add('active');
                    // Show corresponding content
                    showContent(this.getAttribute('data-content'));
                });
            });
            
            // Mood tracker
            document.querySelectorAll('.mood-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.mood-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    currentMood = this.getAttribute('data-mood');
                    updateMoodMessage();
                    saveMoodHistory();
                    showNotification('Mood updated successfully!', 'success');
                });
            });
            
            // Close profile menu when clicking outside
            document.addEventListener('click', (e) => {
                if (userProfile && profileMenu && !userProfile.contains(e.target) && !profileMenu.contains(e.target)) {
                    profileMenu.style.display = 'none';
                }
            });
            
            // View all focus tasks
            const viewAllFocus = document.getElementById('viewAllFocus');
            if (viewAllFocus) {
                viewAllFocus.addEventListener('click', function() {
                    navItems.forEach(nav => nav.classList.remove('active'));
                    document.querySelector('.nav-item[data-content="focus"]').classList.add('active');
                    showContent('focus');
                });
            }
            
            // View all deadlines
            const viewAllDeadlines = document.getElementById('viewAllDeadlines');
            if (viewAllDeadlines) {
                viewAllDeadlines.addEventListener('click', function() {
                    navItems.forEach(nav => nav.classList.remove('active'));
                    document.querySelector('.nav-item[data-content="deadlines"]').classList.add('active');
                    showContent('deadlines');
                });
            }
            
            // Enable focus mode
            const enableFocusMode = document.getElementById('enableFocusMode');
            if (enableFocusMode) {
                enableFocusMode.addEventListener('click', function() {
                    showNotification('Focus mode enabled! Distractions minimized.', 'success');
                });
            }
            
            console.log("Event listeners setup complete");
        }

        // Create animated particles for background
        function createParticles() {
            console.log("Creating background particles...");
            const particleCount = 50;
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // Random size between 5px and 20px
                const size = Math.random() * 15 + 5;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Random position
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                
                // Random animation delay
                particle.style.animationDelay = `${Math.random() * 15}s`;
                
                if (particlesContainer) {
                    particlesContainer.appendChild(particle);
                }
            }
        }

        // Check for expired tasks (today's tasks that are over)
        function checkForExpiredTasks() {
            console.log("Checking for expired tasks...");
            const today = new Date().toISOString().split('T')[0];
            const lastTaskCheck = localStorage.getItem('lastTaskCheck');
            
            // If we haven't checked today, or it's a new day
            if (!lastTaskCheck || lastTaskCheck !== today) {
                console.log("New day detected, cleaning up expired tasks...");
                const initialTaskCount = tasks.length;
                
                tasks = tasks.filter(task => {
                    // Keep tasks that are completed or have no due date
                    if (task.completed || !task.due) return true;
                    
                    // If task is from yesterday or earlier and not completed, delete it
                    const taskDate = new Date(task.due);
                    const todayDate = new Date();
                    todayDate.setHours(0, 0, 0, 0);
                    
                    return taskDate >= todayDate;
                });
                
                // Save the updated task list
                localStorage.setItem('tasks', JSON.stringify(tasks));
                
                // Update last check date
                localStorage.setItem('lastTaskCheck', today);
                
                // Show notification if tasks were deleted
                if (tasks.length < initialTaskCount) {
                    const deletedCount = initialTaskCount - tasks.length;
                    showNotification(`Cleaned up ${deletedCount} expired task(s) from previous days`, 'info');
                }
                
                console.log("Task cleanup completed. Remaining tasks:", tasks.length);
            } else {
                console.log("Task cleanup already performed today");
            }
        }

        // Notification system
        function showNotification(message, type = 'info') {
            console.log(`Showing notification: ${message} (${type})`);
            if (!notificationContainer) return;
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${getNotificationIcon(type)}"></i>
                <span>${message}</span>
            `;
            
            notificationContainer.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, 5000);
        }

        function getNotificationIcon(type) {
            switch(type) {
                case 'success': return 'check-circle';
                case 'error': return 'exclamation-circle';
                case 'warning': return 'exclamation-triangle';
                default: return 'info-circle';
            }
        }

        // Check if user is logged in
        function checkLoginStatus() {
            console.log("Checking login status...");
            const loggedInUser = localStorage.getItem('currentUser');
            if (loggedInUser) {
                try {
                    currentUser = JSON.parse(loggedInUser);
                    console.log("User found:", currentUser.email);
                    showApp();
                } catch (error) {
                    console.error("Error parsing user data:", error);
                    localStorage.removeItem('currentUser');
                }
            } else {
                console.log("No user logged in");
            }
        }

        // Show the main app
        function showApp() {
            console.log("Showing main application...");
            if (loginPage) loginPage.style.display = 'none';
            if (appContainer) appContainer.style.display = 'block';
            if (aiAssistant) aiAssistant.style.display = 'flex';
            
            updateUserInterface();
            
            // Initialize app data
            updateStreak();
            updateQuickStats();
            updateFocusTasks();
            updateUpcomingDeadlines();
            updateAllTasks();
            updateDailyQuote();
            updateMoodTracker();
            updateDailyChallenge();
            
            showNotification(`Welcome back, ${currentUser.firstName || 'User'}!`, 'success');
        }

        // Toggle between login and signup forms
        function showSignupForm() {
            console.log("Showing signup form");
            if (loginForm) loginForm.style.display = 'none';
            if (signupForm) signupForm.style.display = 'flex';
            if (loginSubtitle) loginSubtitle.textContent = 'Create a new account to get started';
        }

        function showLoginForm() {
            console.log("Showing login form");
            if (signupForm) signupForm.style.display = 'none';
            if (loginForm) loginForm.style.display = 'flex';
            if (loginSubtitle) loginSubtitle.textContent = 'Sign in to access your productivity dashboard';
        }

        // Handle authentication
        function handleLogin() {
            console.log("Login attempt...");
            const email = loginEmail ? loginEmail.value.trim() : '';
            const password = loginPassword ? loginPassword.value : '';

            if (!email || !password) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            // Login
            const user = users.find(u => u.email === email && u.password === password);
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                console.log("Login successful for:", email);
                showApp();
                showNotification('Login successful!', 'success');
            } else {
                console.log("Login failed for:", email);
                showNotification('Invalid email or password', 'error');
            }
        }

        function handleSignup() {
            console.log("Signup attempt...");
            const firstName = signupFirstName ? signupFirstName.value.trim() : '';
            const lastName = signupLastName ? signupLastName.value.trim() : '';
            const email = signupEmail ? signupEmail.value.trim() : '';
            const password = signupPassword ? signupPassword.value : '';
            const confirmPassword = signupConfirmPassword ? signupConfirmPassword.value : '';

            if (!firstName || !lastName || !email || !password || !confirmPassword) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showNotification('Passwords do not match', 'error');
                return;
            }

            if (users.find(u => u.email === email)) {
                showNotification('Email already exists', 'error');
                return;
            }

            // Create new user with proper structure
            const newUser = {
                id: Date.now(),
                firstName: firstName,
                lastName: lastName,
                email: email,
                password: password,
                theme: 'light'
            };

            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            console.log("New user created:", email);
            showNotification('Account created successfully!', 'success');
            
            // Reset form and show login
            setTimeout(() => {
                if (signupFirstName) signupFirstName.value = '';
                if (signupLastName) signupLastName.value = '';
                if (signupEmail) signupEmail.value = '';
                if (signupPassword) signupPassword.value = '';
                if (signupConfirmPassword) signupConfirmPassword.value = '';
                if (passwordStrength) passwordStrength.className = 'password-strength';
                if (passwordMatch) passwordMatch.className = 'password-match';
                showLoginForm();
            }, 1500);
        }

        // Password strength checker
        function checkPasswordStrength() {
            const password = signupPassword ? signupPassword.value : '';
            const strengthBar = passwordStrength ? passwordStrength.querySelector('.password-strength-bar') : null;
            
            // Reset classes
            if (passwordStrength) passwordStrength.className = 'password-strength';
            
            if (password.length === 0) {
                return;
            }
            
            let strength = 0;
            
            // Check password length
            if (password.length >= 8) strength += 1;
            
            // Check for lowercase letters
            if (/[a-z]/.test(password)) strength += 1;
            
            // Check for uppercase letters
            if (/[A-Z]/.test(password)) strength += 1;
            
            // Check for numbers
            if (/[0-9]/.test(password)) strength += 1;
            
            // Check for special characters
            if (/[^A-Za-z0-9]/.test(password)) strength += 1;
            
            // Update strength indicator
            if (passwordStrength) {
                if (strength <= 2) {
                    passwordStrength.classList.add('weak');
                } else if (strength <= 4) {
                    passwordStrength.classList.add('medium');
                } else {
                    passwordStrength.classList.add('strong');
                }
            }
        }

        // Password match checker
        function checkPasswordMatch() {
            const password = signupPassword ? signupPassword.value : '';
            const confirmPassword = signupConfirmPassword ? signupConfirmPassword.value : '';
            
            if (passwordMatch) passwordMatch.className = 'password-match';
            
            if (confirmPassword.length === 0) {
                return;
            }
            
            if (passwordMatch) {
                if (password === confirmPassword) {
                    passwordMatch.textContent = 'Passwords match';
                    passwordMatch.classList.add('valid');
                } else {
                    passwordMatch.textContent = 'Passwords do not match';
                    passwordMatch.classList.add('invalid');
                }
            }
        }

        // Update user interface
        function updateUserInterface() {
            if (currentUser) {
                const displayName = currentUser.firstName || currentUser.email || 'User';
                
                if (userAvatar) userAvatar.textContent = displayName.charAt(0).toUpperCase();
                if (userName) userName.textContent = displayName;
                
                if (profileEmail) profileEmail.textContent = `Email: ${currentUser.email}`;
                
                if (greetingMessage) greetingMessage.textContent = `${getGreeting()}, ${displayName}!`;
                
                // Apply user theme preference
                if (currentUser.theme === 'dark') {
                    document.body.classList.add('dark-mode');
                    if (themeToggle) themeToggle.innerHTML = '<i class="fas fa-sun"></i><span>Light Mode</span>';
                } else {
                    document.body.classList.remove('dark-mode');
                    if (themeToggle) themeToggle.innerHTML = '<i class="fas fa-moon"></i><span>Dark Mode</span>';
                }
            }
        }

        // Toggle theme
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            if (document.body.classList.contains('dark-mode')) {
                if (themeToggle) themeToggle.innerHTML = '<i class="fas fa-sun"></i><span>Light Mode</span>';
                if (currentUser) {
                    currentUser.theme = 'dark';
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                }
                showNotification('Dark mode enabled', 'info');
            } else {
                if (themeToggle) themeToggle.innerHTML = '<i class="fas fa-moon"></i><span>Dark Mode</span>';
                if (currentUser) {
                    currentUser.theme = 'light';
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                }
                showNotification('Light mode enabled', 'info');
            }
        }

        // Toggle profile menu
        function toggleProfileMenu() {
            if (profileMenu) {
                if (profileMenu.style.display === 'block') {
                    profileMenu.style.display = 'none';
                } else {
                    profileMenu.style.display = 'block';
                }
            }
        }

        // Logout function - FIXED
        function handleLogout() {
            console.log("Logging out...");
            currentUser = null;
            localStorage.removeItem('currentUser');
            
            if (appContainer) appContainer.style.display = 'none';
            if (aiAssistant) aiAssistant.style.display = 'none';
            if (aiChatWidget) aiChatWidget.style.display = 'none';
            if (loginPage) loginPage.style.display = 'flex';
            if (profileMenu) profileMenu.style.display = 'none';
            
            // Reset form
            if (loginEmail) loginEmail.value = '';
            if (loginPassword) loginPassword.value = '';
            if (signupFirstName) signupFirstName.value = '';
            if (signupLastName) signupLastName.value = '';
            if (signupEmail) signupEmail.value = '';
            if (signupPassword) signupPassword.value = '';
            if (signupConfirmPassword) signupConfirmPassword.value = '';
            if (passwordStrength) passwordStrength.className = 'password-strength';
            if (passwordMatch) passwordMatch.className = 'password-match';
            
            showLoginForm();
            showNotification('Logged out successfully', 'info');
        }

        // Show content based on navigation
        function showContent(contentId) {
            console.log("Showing content:", contentId);
            // Hide all content sections
            contentSections.forEach(section => {
                section.classList.remove('active');
            });
            
            // Show the selected content section
            const contentElement = document.getElementById(`${contentId}Content`);
            if (contentElement) {
                contentElement.classList.add('active');
                
                // Update specific content if needed
                if (contentId === 'calendar') {
                    updateCalendar();
                } else if (contentId === 'analytics') {
                    updateAnalytics();
                } else if (contentId === 'reports') {
                    updateReports();
                } else if (contentId === 'focus') {
                    updateFocusTasksDetailed();
                } else if (contentId === 'deadlines') {
                    updateDeadlinesList();
                } else if (contentId === 'quotes') {
                    updateDailyQuoteDetailed();
                } else if (contentId === 'challenge') {
                    updateDailyChallenge();
                } else if (contentId === 'mood') {
                    updateMoodChart();
                }
                
                showNotification(`Navigated to ${contentId}`, 'info');
            }
        }

        // Update date and time
        function updateDateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            };
            if (currentDateTime) {
                currentDateTime.textContent = now.toLocaleDateString('en-US', options);
            }
        }

        // Get greeting based on time of day
        function getGreeting() {
            const hour = new Date().getHours();
            if (hour < 12) return 'Good Morning';
            if (hour < 18) return 'Good Afternoon';
            return 'Good Evening';
        }

        // Update streak
        function updateStreak() {
            const today = new Date().toDateString();
            
            // If user was active today, no need to update
            if (streakData.lastActiveDate === today) {
                if (streakCount) streakCount.textContent = `ðŸ”¥ ${streakData.currentStreak} day streak`;
                return;
            }
            
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayStr = yesterday.toDateString();
            
            // If user was active yesterday, increment streak
            if (streakData.lastActiveDate === yesterdayStr) {
                streakData.currentStreak += 1;
            } 
            // If user wasn't active yesterday but was active today, maintain streak
            else if (streakData.lastActiveDate !== today) {
                // If it's been more than one day, reset streak
                streakData.currentStreak = 1;
            }
            
            streakData.lastActiveDate = today;
            localStorage.setItem('streakData', JSON.stringify(streakData));
            if (streakCount) streakCount.textContent = `ðŸ”¥ ${streakData.currentStreak} day streak`;
        }

        // Update quick stats
        function updateQuickStats() {
            const total = tasks.length;
            const completed = tasks.filter(t => t.completed).length;
            const pending = total - completed;
            const overdue = tasks.filter(t => 
                !t.completed && t.due && new Date(t.due) < new Date()
            ).length;
            
            if (totalTasks) totalTasks.textContent = total;
            if (completedTasks) completedTasks.textContent = completed;
            if (pendingTasks) pendingTasks.textContent = pending;
            if (overdueTasks) overdueTasks.textContent = overdue;
            
            const percent = total > 0 ? Math.round((completed / total) * 100) : 0;
            if (progressBar) progressBar.style.width = `${percent}%`;
            if (progressPercentage) progressPercentage.textContent = `${percent}%`;
        }

        // Update focus tasks
        function updateFocusTasks() {
            if (!focusTasks) return;
            
            // Get top 3 high priority tasks for today
            const today = new Date().toISOString().split('T')[0];
            const focusTasksList = tasks
                .filter(t => !t.completed && (t.priority === 'high' || t.due === today))
                .slice(0, 3);
            
            if (focusTasksList.length === 0) {
                focusTasks.innerHTML = '<p>No high-priority tasks for today. Add some tasks or enjoy your day!</p>';
                return;
            }
            
            focusTasks.innerHTML = focusTasksList.map(task => `
                <div class="task-item">
                    <div class="task-checkbox ${task.completed ? 'checked' : ''}" data-id="${task.id}">
                        ${task.completed ? '<i class="fas fa-check"></i>' : ''}
                    </div>
                    <div class="task-content">
                        <div class="task-title">${task.title}</div>
                        <div class="task-meta">
                            ${task.due ? `<span><i class="far fa-calendar-alt"></i> ${formatDate(task.due)}</span>` : ''}
                            <span class="task-priority priority-${task.priority}">
                                ${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Add event listeners to checkboxes
            document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                checkbox.addEventListener('click', function() {
                    const taskId = parseInt(this.getAttribute('data-id'));
                    toggleComplete(taskId);
                });
            });
        }

        // Update focus tasks detailed view
        function updateFocusTasksDetailed() {
            const focusTasksDetailed = document.getElementById('focusTasksDetailed');
            if (!focusTasksDetailed) return;
            
            // Get all high priority tasks
            const focusTasksList = tasks.filter(t => !t.completed && t.priority === 'high');
            
            if (focusTasksList.length === 0) {
                focusTasksDetailed.innerHTML = '<p>No focus tasks. Add high-priority tasks to see them here.</p>';
                return;
            }
            
            focusTasksDetailed.innerHTML = focusTasksList.map(task => `
                <div class="task-item">
                    <div class="task-checkbox ${task.completed ? 'checked' : ''}" data-id="${task.id}">
                        ${task.completed ? '<i class="fas fa-check"></i>' : ''}
                    </div>
                    <div class="task-content">
                        <div class="task-title">${task.title}</div>
                        <div class="task-meta">
                            ${task.due ? `<span><i class="far fa-calendar-alt"></i> ${formatDate(task.due)}</span>` : ''}
                            <span class="task-priority priority-${task.priority}">
                                ${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Add event listeners to checkboxes
            document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                checkbox.addEventListener('click', function() {
                    const taskId = parseInt(this.getAttribute('data-id'));
                    toggleComplete(taskId);
                });
            });
        }

        // Update upcoming deadlines
        function updateUpcomingDeadlines() {
            if (!upcomingDeadlines) return;
            
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            const upcoming = tasks
                .filter(t => !t.completed && t.due)
                .map(t => {
                    const dueDate = new Date(t.due);
                    const diffTime = dueDate - today;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    let urgency = 'low';
                    if (diffDays < 0) urgency = 'high';
                    else if (diffDays <= 1) urgency = 'medium';
                    
                    return { ...t, diffDays, urgency };
                })
                .sort((a, b) => new Date(a.due) - new Date(b.due))
                .slice(0, 5);
            
            if (upcoming.length === 0) {
                upcomingDeadlines.innerHTML = '<p>No upcoming deadlines. Great job!</p>';
                return;
            }
            
            upcomingDeadlines.innerHTML = upcoming.map(task => `
                <div class="task-item">
                    <div class="task-content">
                        <div class="task-title">${task.title}</div>
                        <div class="task-meta">
                            <span><i class="far fa-calendar-alt"></i> ${formatDate(task.due)}</span>
                            <span class="task-priority priority-${task.urgency}">
                                ${task.urgency.charAt(0).toUpperCase() + task.urgency.slice(1)} Priority
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Update deadlines list
        function updateDeadlinesList() {
            const deadlinesList = document.getElementById('deadlinesList');
            if (!deadlinesList) return;
            
            const today = new Date();
            const deadlines = tasks
                .filter(t => !t.completed && t.due)
                .map(t => {
                    const dueDate = new Date(t.due);
                    const diffTime = dueDate - today;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    let urgency = 'low';
                    if (diffDays < 0) urgency = 'high';
                    else if (diffDays <= 1) urgency = 'medium';
                    
                    return { ...t, diffDays, urgency };
                })
                .sort((a, b) => new Date(a.due) - new Date(b.due));
            
            if (deadlines.length === 0) {
                deadlinesList.innerHTML = '<p>No deadlines. Great job!</p>';
                return;
            }
            
            deadlinesList.innerHTML = deadlines.map(task => `
                <div class="task-item">
                    <div class="task-checkbox ${task.completed ? 'checked' : ''}" data-id="${task.id}">
                        ${task.completed ? '<i class="fas fa-check"></i>' : ''}
                    </div>
                    <div class="task-content">
                        <div class="task-title">${task.title}</div>
                        <div class="task-meta">
                            <span><i class="far fa-calendar-alt"></i> ${formatDate(task.due)}</span>
                            <span class="task-priority priority-${task.urgency}">
                                ${task.urgency.charAt(0).toUpperCase() + task.urgency.slice(1)} Priority
                            </span>
                            <span>${task.diffDays < 0 ? 'Overdue' : `${task.diffDays} days left`}</span>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Add event listeners to checkboxes
            document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                checkbox.addEventListener('click', function() {
                    const taskId = parseInt(this.getAttribute('data-id'));
                    toggleComplete(taskId);
                });
            });
        }

        // Update all tasks
        function updateAllTasks() {
            if (!allTasksList) return;
            
            if (tasks.length === 0) {
                allTasksList.innerHTML = '<p>No tasks yet. Add your first task above!</p>';
                return;
            }
            
            allTasksList.innerHTML = tasks.map(task => `
                <div class="task-item">
                    <div class="task-checkbox ${task.completed ? 'checked' : ''}" data-id="${task.id}">
                        ${task.completed ? '<i class="fas fa-check"></i>' : ''}
                    </div>
                    <div class="task-content">
                        <div class="task-title">${task.title}</div>
                        <div class="task-meta">
                            ${task.due ? `<span><i class="far fa-calendar-alt"></i> ${formatDate(task.due)}</span>` : ''}
                            <span class="task-priority priority-${task.priority}">
                                ${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}
                            </span>
                            <span>${task.category.charAt(0).toUpperCase() + task.category.slice(1)}</span>
                        </div>
                    </div>
                    <button class="delete-task" data-id="${task.id}" style="background: none; border: none; color: var(--danger-color); cursor: pointer;">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `).join('');
            
            // Add event listeners to checkboxes
            document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                checkbox.addEventListener('click', function() {
                    const taskId = parseInt(this.getAttribute('data-id'));
                    toggleComplete(taskId);
                });
            });
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-task').forEach(button => {
                button.addEventListener('click', function() {
                    const taskId = parseInt(this.getAttribute('data-id'));
                    deleteTask(taskId);
                });
            });
        }

        // Add new task
        function addNewTask() {
            const title = taskTitle ? taskTitle.value.trim() : '';
            if (!title) {
                showNotification('Please enter a task title', 'error');
                return;
            }
            
            const newTask = {
                id: Date.now(),
                title,
                completed: false,
                priority: taskPriority ? taskPriority.value : 'medium',
                category: taskCategory ? taskCategory.value : 'general',
                due: taskDueDate ? taskDueDate.value || null : null,
                createdAt: new Date().toISOString()
            };
            
            tasks.push(newTask);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            
            if (taskTitle) taskTitle.value = '';
            if (taskDueDate) taskDueDate.value = '';
            
            updateQuickStats();
            updateFocusTasks();
            updateUpcomingDeadlines();
            updateAllTasks();
            
            showNotification('Task added successfully!', 'success');
        }

        // Toggle task completion
        function toggleComplete(id) {
            const task = tasks.find(t => t.id === id);
            if (!task) return;
            
            tasks = tasks.map(t => t.id === id ? {...t, completed: !t.completed} : t);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            updateQuickStats();
            updateFocusTasks();
            updateUpcomingDeadlines();
            updateAllTasks();
            
            // Update challenge progress if task was completed
            if (tasks.find(t => t.id === id).completed) {
                updateChallengeProgress();
                showNotification(`Task "${task.title}" completed!`, 'success');
            } else {
                showNotification(`Task "${task.title}" marked as incomplete`, 'info');
            }
        }

        // Delete task
        function deleteTask(id) {
            const task = tasks.find(t => t.id === id);
            if (!task) return;
            
            tasks = tasks.filter(t => t.id !== id);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            updateQuickStats();
            updateFocusTasks();
            updateUpcomingDeadlines();
            updateAllTasks();
            
            showNotification(`Task "${task.title}" deleted`, 'info');
        }

        // Update daily quote
        function updateDailyQuote() {
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            if (dailyQuote) dailyQuote.textContent = `"${randomQuote}"`;
            
            if (dailyQuoteDetailed) {
                dailyQuoteDetailed.innerHTML = `<p style="font-size: 1.2rem; font-style: italic;">"${randomQuote}"</p>`;
            }
            
            showNotification('New quote loaded!', 'info');
        }

        // Update daily quote detailed view
        function updateDailyQuoteDetailed() {
            if (!dailyQuoteDetailed) return;
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            dailyQuoteDetailed.innerHTML = `<p style="font-size: 1.2rem; font-style: italic;">"${randomQuote}"</p>`;
        }

        // Format date
        function formatDate(dateStr) {
            if (!dateStr) return '';
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateStr).toLocaleDateString(undefined, options);
        }

        // Timer functions
        function startFocusTimer() {
            if (isTimerRunning) return;
            
            isTimerRunning = true;
            timerInterval = setInterval(() => {
                timerSeconds--;
                updateTimerDisplay();
                
                if (timerSeconds <= 0) {
                    clearInterval(timerInterval);
                    isTimerRunning = false;
                    showNotification('Focus session completed! Time for a break.', 'success');
                }
            }, 1000);
            
            showNotification('Focus timer started', 'info');
        }

        function pauseFocusTimer() {
            if (!isTimerRunning) return;
            
            clearInterval(timerInterval);
            isTimerRunning = false;
            showNotification('Focus timer paused', 'warning');
        }

        function resetFocusTimer() {
            clearInterval(timerInterval);
            isTimerRunning = false;
            updateTimerDuration();
            showNotification('Focus timer reset', 'info');
        }

        function updateTimerDuration() {
            timerSeconds = timerDuration ? parseInt(timerDuration.value) * 60 : 25 * 60;
            updateTimerDisplay();
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timerSeconds / 60);
            const seconds = timerSeconds % 60;
            if (timerDisplay) {
                timerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }
        }

        // Mood tracker functions
        function updateMoodTracker() {
            // Check if user has already set mood today
            const today = new Date().toDateString();
            const todayMood = moodHistory.find(m => m.date === today);
            
            if (todayMood) {
                currentMood = todayMood.mood;
                const moodElement = document.querySelector(`.mood-option[data-mood="${currentMood}"]`);
                if (moodElement) moodElement.classList.add('selected');
                updateMoodMessage();
            }
        }

        function updateMoodMessage() {
            const messages = {
                happy: "Great to see you're happy! Keep up the positive energy!",
                neutral: "Hope you have a productive day!",
                sad: "It's okay to have off days. Remember to take care of yourself.",
                excited: "Your excitement is contagious! Channel that energy into your work!",
                tired: "Remember to take breaks and rest when needed. Your well-being is important."
            };
            
            if (moodMessage) {
                moodMessage.textContent = messages[currentMood] || "Thanks for sharing how you're feeling!";
            }
        }

        function saveMoodHistory() {
            const today = new Date().toDateString();
            const existingIndex = moodHistory.findIndex(m => m.date === today);
            
            if (existingIndex !== -1) {
                moodHistory[existingIndex].mood = currentMood;
            } else {
                moodHistory.push({
                    date: today,
                    mood: currentMood
                });
            }
            
            localStorage.setItem('moodHistory', JSON.stringify(moodHistory));
        }

        // Challenge functions
        function updateDailyChallenge() {
            if (!dailyChallenge) return;
            
            // Check if we need to reset challenge for a new day
            const today = new Date().toDateString();
            if (challengeData.lastChallengeDate !== today) {
                challengeData.progress = 0;
                challengeData.completed = false;
                challengeData.lastChallengeDate = today;
                localStorage.setItem('challengeData', JSON.stringify(challengeData));
            }
            
            // Get a random challenge
            const randomChallenge = challenges[Math.floor(Math.random() * challenges.length)];
            dailyChallenge.innerHTML = `<p style="font-size: 1.2rem;">${randomChallenge}</p>`;
            
            // Update progress
            if (challengeProgress) challengeProgress.style.width = `${challengeData.progress}%`;
            if (challengePercentage) challengePercentage.textContent = `${challengeData.progress}%`;
        }

        function updateChallengeProgress() {
            if (challengeData.completed) return;
            
            challengeData.progress += 20;
            if (challengeData.progress >= 100) {
                challengeData.progress = 100;
                challengeData.completed = true;
                showNotification('Congratulations! You completed your daily challenge!', 'success');
            }
            
            localStorage.setItem('challengeData', JSON.stringify(challengeData));
            if (challengeProgress) challengeProgress.style.width = `${challengeData.progress}%`;
            if (challengePercentage) challengePercentage.textContent = `${challengeData.progress}%`;
        }

        // Calendar functions
        function updateCalendar() {
            const calendarView = document.getElementById('calendarView');
            if (!calendarView) return;
            
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth();
            
            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            
            // Create calendar HTML
            let calendarHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3>${today.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}</h3>
                </div>
                <table class="calendar">
                    <thead>
                        <tr>
                            <th>Sun</th>
                            <th>Mon</th>
                            <th>Tue</th>
                            <th>Wed</th>
                            <th>Thu</th>
                            <th>Fri</th>
                            <th>Sat</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            // Start with empty cells for days before the first day of the month
            let dayCount = 1;
            calendarHTML += '<tr>';
            for (let i = 0; i < firstDay.getDay(); i++) {
                calendarHTML += '<td></td>';
            }
            
            // Add days of the month
            for (let i = firstDay.getDay(); i < 7 && dayCount <= daysInMonth; i++) {
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(dayCount).padStart(2, '0')}`;
                const hasTasks = tasks.some(t => t.due === dateStr);
                const isToday = dayCount === today.getDate() && month === today.getMonth();
                
                let dayClass = '';
                if (isToday) dayClass = 'today';
                if (hasTasks) dayClass += ' has-task';
                
                calendarHTML += `<td class="${dayClass}">${dayCount}</td>`;
                dayCount++;
            }
            calendarHTML += '</tr>';
            
            // Continue with remaining weeks
            while (dayCount <= daysInMonth) {
                calendarHTML += '<tr>';
                for (let i = 0; i < 7 && dayCount <= daysInMonth; i++) {
                    const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(dayCount).padStart(2, '0')}`;
                    const hasTasks = tasks.some(t => t.due === dateStr);
                    const isToday = dayCount === today.getDate() && month === today.getMonth();
                    
                    let dayClass = '';
                    if (isToday) dayClass = 'today';
                    if (hasTasks) dayClass += ' has-task';
                    
                    calendarHTML += `<td class="${dayClass}">${dayCount}</td>`;
                    dayCount++;
                }
                calendarHTML += '</tr>';
            }
            
            calendarHTML += '</tbody></table>';
            calendarView.innerHTML = calendarHTML;
        }

        // Analytics functions
        function initializeCharts() {
            // Completion chart
            const completionCtx = document.getElementById('completionChart');
            if (completionCtx) {
                // Destroy existing chart if it exists
                if (completionChart) {
                    completionChart.destroy();
                }
                
                completionChart = new Chart(completionCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Completed', 'Pending'],
                        datasets: [{
                            data: [tasks.filter(t => t.completed).length, tasks.filter(t => !t.completed).length],
                            backgroundColor: [
                                'rgba(40, 167, 69, 0.8)',
                                'rgba(108, 117, 125, 0.8)'
                            ],
                            borderColor: [
                                'rgba(40, 167, 69, 1)',
                                'rgba(108, 117, 125, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }
            
            // Category chart
            const categoryCtx = document.getElementById('categoryChart');
            if (categoryCtx) {
                // Destroy existing chart if it exists
                if (categoryChart) {
                    categoryChart.destroy();
                }
                
                const categories = ['general', 'work', 'personal', 'health'];
                const categoryCounts = categories.map(cat => 
                    tasks.filter(t => t.category === cat).length
                );
                
                categoryChart = new Chart(categoryCtx, {
                    type: 'bar',
                    data: {
                        labels: ['General', 'Work', 'Personal', 'Health'],
                        datasets: [{
                            label: 'Tasks by Category',
                            data: categoryCounts,
                            backgroundColor: 'rgba(74, 111, 165, 0.8)',
                            borderColor: 'rgba(74, 111, 165, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });
            }
        }

        function updateAnalytics() {
            initializeCharts();
        }

        function updateReports() {
            // Weekly chart
            const weeklyCtx = document.getElementById('weeklyChart');
            if (weeklyCtx) {
                // Destroy existing chart if it exists
                if (weeklyChart) {
                    weeklyChart.destroy();
                }
                
                // Generate weekly data (last 7 days)
                const days = [];
                const completedTasksByDay = [];
                const totalTasksByDay = [];
                
                for (let i = 6; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    const dateStr = date.toISOString().split('T')[0];
                    
                    // Format day name
                    const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
                    days.push(dayName);
                    
                    // Count tasks for this day
                    const dayTasks = tasks.filter(task => {
                        const taskDate = new Date(task.createdAt).toISOString().split('T')[0];
                        return taskDate === dateStr;
                    });
                    
                    totalTasksByDay.push(dayTasks.length);
                    completedTasksByDay.push(dayTasks.filter(t => t.completed).length);
                }
                
                weeklyChart = new Chart(weeklyCtx, {
                    type: 'line',
                    data: {
                        labels: days,
                        datasets: [
                            {
                                label: 'Total Tasks',
                                data: totalTasksByDay,
                                borderColor: 'rgba(74, 111, 165, 1)',
                                backgroundColor: 'rgba(74, 111, 165, 0.1)',
                                tension: 0.3,
                                fill: true
                            },
                            {
                                label: 'Completed Tasks',
                                data: completedTasksByDay,
                                borderColor: 'rgba(40, 167, 69, 1)',
                                backgroundColor: 'rgba(40, 167, 69, 0.1)',
                                tension: 0.3,
                                fill: true
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
            
            // Productivity insights
            updateProductivityInsights();
        }

        function updateProductivityInsights() {
            const productivityInsights = document.getElementById('productivityInsights');
            if (!productivityInsights) return;
            
            const completed = tasks.filter(t => t.completed).length;
            const total = tasks.length;
            const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
            
            // Calculate average tasks per day
            const taskDates = tasks.map(t => new Date(t.createdAt).toDateString());
            const uniqueDays = [...new Set(taskDates)].length;
            const avgTasksPerDay = uniqueDays > 0 ? (total / uniqueDays).toFixed(1) : 0;
            
            let insightsHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div style="text-align: center; padding: 15px; background: rgba(74, 111, 165, 0.1); border-radius: var(--border-radius);">
                        <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary-color);">${completionRate}%</div>
                        <div>Completion Rate</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: rgba(74, 111, 165, 0.1); border-radius: var(--border-radius);">
                        <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary-color);">${streakData.currentStreak}</div>
                        <div>Current Streak</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: rgba(74, 111, 165, 0.1); border-radius: var(--border-radius);">
                        <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary-color);">${avgTasksPerDay}</div>
                        <div>Avg Tasks/Day</div>
                    </div>
                </div>
            `;
            
            if (completionRate >= 80) {
                insightsHTML += `<p style="color: var(--success-color); font-weight: bold;">Excellent work! You're maintaining high productivity.</p>`;
            } else if (completionRate >= 50) {
                insightsHTML += `<p style="color: var(--warning-color); font-weight: bold;">Good progress! Keep focusing on your priorities.</p>`;
            } else {
                insightsHTML += `<p style="color: var(--danger-color); font-weight: bold;">Try to focus on completing more tasks to improve your productivity.</p>`;
            }
            
            // Add recommendation based on data
            if (streakData.currentStreak >= 7) {
                insightsHTML += `<p style="color: var(--success-color);">Amazing! You've maintained a ${streakData.currentStreak}-day streak. Keep up the great work!</p>`;
            } else if (streakData.currentStreak >= 3) {
                insightsHTML += `<p style="color: var(--success-color);">Good job on your ${streakData.currentStreak}-day streak! Consistency is key to productivity.</p>`;
            }
            
            productivityInsights.innerHTML = insightsHTML;
        }

        // Mood chart
        function updateMoodChart() {
            const moodCtx = document.getElementById('moodChart');
            if (!moodCtx || moodHistory.length === 0) return;
            
            // Destroy existing chart if it exists
            if (moodChart) {
                moodChart.destroy();
            }
            
            // Get last 7 days of mood data
            const last7Days = [];
            const moodValues = [];
            const moodMap = { happy: 5, excited: 4, neutral: 3, tired: 2, sad: 1 };
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateStr = date.toDateString();
                
                // Format day name
                const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
                last7Days.push(dayName);
                
                // Find mood for this day
                const dayMood = moodHistory.find(m => m.date === dateStr);
                moodValues.push(dayMood ? moodMap[dayMood.mood] : null);
            }
            
            moodChart = new Chart(moodCtx, {
                type: 'line',
                data: {
                    labels: last7Days,
                    datasets: [{
                        label: 'Mood Level',
                        data: moodValues,
                        borderColor: 'rgba(255, 126, 95, 1)',
                        backgroundColor: 'rgba(255, 126, 95, 0.1)',
                        tension: 0.3,
                        fill: true,
                        pointBackgroundColor: 'rgba(255, 126, 95, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            min: 0,
                            max: 5,
                            ticks: {
                                callback: function(value) {
                                    const moodLabels = { 1: 'Sad', 2: 'Tired', 3: 'Neutral', 4: 'Excited', 5: 'Happy' };
                                    return moodLabels[value] || '';
                                }
                            }
                        }
                    }
                }
            });
        }

        // AI Chat functions
        function toggleAIChat() {
            if (aiChatWidget) {
                if (aiChatWidget.style.display === 'flex') {
                    aiChatWidget.style.display = 'none';
                } else {
                    aiChatWidget.style.display = 'flex';
                    if (chatInput) chatInput.focus();
                }
            }
        }

        function sendAIMessage() {
            const message = chatInput ? chatInput.value.trim() : '';
            if (!message) return;
            
            // Add user message to chat
            addChatMessage(message, 'user');
            if (chatInput) chatInput.value = '';
            
            // Simulate AI response
            setTimeout(() => {
                let response = generateAIResponse(message);
                addChatMessage(response, 'ai');
            }, 1000);
        }

        function addChatMessage(message, sender) {
            if (!chatMessages) return;
            
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}`;
            messageElement.textContent = message;
            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function generateAIResponse(message) {
            message = message.toLowerCase();
            
            if (message.includes('hello') || message.includes('hi')) {
                return "Hello! How can I help you with your productivity today?";
            } else if (message.includes('task') || message.includes('todo')) {
                return "You can manage your tasks in the 'Tasks' section. Would you like me to help you add a new task?";
            } else if (message.includes('progress') || message.includes('stats')) {
                return "Check your progress in the 'Dashboard' section. You can see completion rates and task statistics there.";
            } else if (message.includes('motivation') || message.includes('quote')) {
                return quotes[Math.floor(Math.random() * quotes.length)];
            } else if (message.includes('help')) {
                return "I can help you with: task management, progress tracking, motivation, and answering general questions about the app.";
            } else if (message.includes('calendar') || message.includes('schedule')) {
                return "You can view your tasks on a calendar in the 'Calendar' section.";
            } else if (message.includes('focus') || message.includes('timer')) {
                return "Use the 'Focus Timer' to work in focused sessions using the Pomodoro technique.";
            } else if (message.includes('mood') || message.includes('feeling')) {
                return "Track your mood in the 'How Are You Feeling?' section. It's important to be aware of your emotional state.";
            } else {
                return "I'm here to help with your productivity! You can ask me about tasks, progress, or motivation.";
            }
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM fully loaded, initializing app...");
            init();
        });

        // Fallback initialization
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>  